<%
var RIGHTHTML = {
%>

<div :controller="app">
    <h3 :html="@data.title"></h3>

    <div>
        <h4>选择业务版本</h4>
        <select name="" id="" :duplex="version">
            <option value="">选择业务版本</option>
            <option :attr="{value:@data.workflow.version}" :html="@data.workflow.version"></option>
        </select>
    </div>

    <div :for="(index,el) in @data.workflow.model" :if="index == @data.step" class="step_form">
        <wbr :widget="{is: el.type + 'Node',data: el, edit:false }"/>
    </div>


    <a href="javascript:;" :click="submit()">提交</a>
</div>

<script>
    var workflowstr = '${workflow}';
    var userstr = '${user}';
    var workflow;
    var user;
    do{
        try{
            workflow = eval("(" + workflowstr + ")");
            user = eval("(" + userstr + ")");
        }catch (e){
            break;
        }
    }while(0);


    var app = avalon.define({
        $id: 'app',
        data: {
            title: workflow.name,
            workflow : workflow,
            step:0,
            version:""
            // user
        },
        submit:function(){
            //当前需要填写的节点
            var model = this.data.workflow.model[this.data.step];
            if(model.type == 'ziliao'){

            }
        }
    });
</script>

<% }; %>

<%
include("../layout.html",{RIGHTHTML:RIGHTHTML}){}
%>