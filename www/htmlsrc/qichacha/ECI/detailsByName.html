<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> 公司详情 </title>
    <!--#include file="/htmlsrc/header.html" -->
    <script>
        var keyNoPromise = $.Deferred();
        var COMPANY_NAME =  "惠州市帅星贸易有限公司" || getParam("keyWord");
        var COMPANY_KEY_NO = getParam("keyNo") || "";
    </script>
</head>
<body>
<div id="content">
    <div id="dataList">
        <div class="qcc-detail-inner col-xs-10" data-example-id="togglable-tabs">
            <ul id="myTabs" class="nav nav-tabs" role="tablist" style="background: #fff">
                <li role="presentation" class="active"><a href="#base" id="base-tab" role="tab" data-toggle="tab" data-controls="base" aria-expanded="true">基本信息</a></li>
                <li role="presentation" class=""><a href="#susong" role="tab" id="susong-tab" data-toggle="tab" data-controls="susong" title="双击展开/关闭全部">法律诉讼</a></li>
                <!--<li role="presentation" class=""><a href="#run" role="tab" id="run-tab" data-toggle="tab" data-controls="run">经营状况</a></li>-->
                <li role="presentation" class=""><a href="#fengxian" role="tab" id="fengxian-tab" data-toggle="tab" data-controls="fengxian">经营风险</a></li>
                <!--<li role="presentation" class=""><a href="#report" role="tab" id="report-tab" data-toggle="tab" data-controls="report">企业发展</a></li>-->
                <!--<li role="presentation" class=""><a href="#assets" role="tab" id="assets-tab" data-toggle="tab" data-controls="assets">知识产权</a></li>-->
                <li role="presentation" class=""><a href="#history" role="tab" id="history-tab" data-toggle="tab" data-controls="history">历史信息</a></li>
                <li style="float: right;"><a href="javascript:;" id="updateBtn" style="background: orange;color: #fff;" >更新当前模块数据</a></li>
            </ul>
            <div id="qcc-detail-content" class="tab-content" style="padding-top: 10px;">
                <!--#include file="./detailsByName_1.html"-->
                <!--#include file="./detailsByName_2.html"-->
                <!--##include file="./detailsByName_3.html"-->
                <!--#include file="./detailsByName_4.html"-->
                <!--##include file="./detailsByName_5.html"-->
                <!--##include file="./detailsByName_6.html"-->
                <!--#include file="./detailsByName_7.html"-->
            </div>
        </div>
        <!--#include file="./rightSide.html" -->
    </div>
</div>

<script src="/tmpl/js/chattelMortgage.js"></script>
<script>
    $("#myTabs li a").dblclick(function () {
        $(this).toggleClass("switch");
        if($(this).hasClass("switch")){
            $($(this).attr("href")).find(".panel-collapse").collapse("show");
        }else{
            $($(this).attr("href")).find(".panel-collapse").collapse("hide");
        }
    });

    // 更新模块数据
    $("#updateBtn").click(function () {
        var currBlockIndex = $("#myTabs li.active").index();
        var url = "http://localhost:8079/qcc/loadData/";
        if(currBlockIndex === 0){
            // 基本信息
            url += "loadDataBlock1";
        }else if(currBlockIndex === 1){
            url += "loadDataBlock2";
        }else if(currBlockIndex === 2){
            // 经营风险
            if(COMPANY_KEY_NO == ""){
                layer.msg("keyNo为空，请确保工商信息已获取且页面加载完成！");
                return false;
            }
            url += "loadDataBlock5";
        }else if(currBlockIndex === 3){
            url += "loadDataBlock4";
        }
        $.ajax({
            url: url,
            data: {
                keyWord: COMPANY_NAME,
                keyNo: COMPANY_KEY_NO
            },
            success: function (res) {
                if(res.success){
                    layer.msg("数据获取成功，请等待数据解构服务处理！");
                }else{
                    layer.msg("数据获取失败！");
                }

            }
        });
    });
    // 点击【法律诉讼】模块后加载此模块数据
    $(document).on("click", "#susong-tab", function () {
        if(loadBlock2Status == false){
            loadBlock2();
        }
    });
    // 点击【经营风险】模块后加载此模块数据
    $(document).on("click", "#fengxian-tab", function () {
        if(loadBlock4Status == false){
            loadBlock4();
        }
    });
    // 点击【历史信息】模块后加载此模块数据
    $(document).on("click", "#history-tab", function () {
        if(loadBlock7Status == false){
            loadBlock7();
        }
    });

</script>
</body>
</html>