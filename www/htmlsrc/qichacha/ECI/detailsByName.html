<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> 公司详情 </title>
    <!--#include file="/htmlsrc/header.html" -->
    <style>
        html{
            overflow: hidden !important;
            height: 100% !important;
        }
        body{
            overflow-y: scroll !important;
            height: 100% !important;
        }
    </style>
    <script>
        var keyNoPromise = $.Deferred();
        var COMPANY_NAME =  decodeURI(getParam("keyWord"));
        var COMPANY_KEY_NO = getParam("keyNo") || "";
        var BOOTSTRAP_INDEX_FILED = {
            title: '序号',
            align: 'center',
            setWidth: 40,
            formatter: function(value, row, index) {
                return index + 1;
            }
        }
        var fixOnDataLoadObj = {};
        var scrollToElm = function (elmId) {
            if(fixOnDataLoadObj[elmId] === undefined){
                fixOnDataLoadObj[elmId] = true;
            }else{
                var container = $('body');
                var scrollTo = $('#'+elmId);
                // 当被隐藏的时候，滚动显示出来
                if(scrollTo.offset().top < 0){
                    container.scrollTop( scrollTo.offset().top - container.offset().top + container.scrollTop() );
                }
            }
        };
        var fixOnDataLoad = function (elmId, data) {
            if(data && data.total && data.total > 0){
                $("a[href='#"+elmId+"']").removeClass("disabled");
                scrollToElm(elmId);
                $("#"+elmId+"-count").html(data.total);
            }
        };
        var subDateStr = function(dateStr){
            if(dateStr){
                return dateStr.substring(0, 10);
            }
        }
    </script>
</head>
<body>
<div id="content">
    <div id="dataList">
        <div class="qcc-detail-inner col-xs-10" data-example-id="togglable-tabs">
            <ul id="myTabs" class="nav nav-tabs" role="tablist" style="background: #fff">
                <li role="presentation" class="active"><a href="#base" id="base-tab" role="tab" data-toggle="tab" data-controls="base" aria-expanded="true">基本信息</a></li>
                <li role="presentation" class=""><a href="#susong" role="tab" id="susong-tab" data-toggle="tab" data-controls="susong" title="双击展开/关闭全部">法律诉讼</a></li>
                <!--<li role="presentation" class=""><a href="#run" role="tab" id="run-tab" data-toggle="tab" data-controls="run">经营状况</a></li>-->
                <li role="presentation" class=""><a href="#fengxian" role="tab" id="fengxian-tab" data-toggle="tab" data-controls="fengxian">经营风险</a></li>
                <!--<li role="presentation" class=""><a href="#report" role="tab" id="report-tab" data-toggle="tab" data-controls="report">企业发展</a></li>-->
                <!--<li role="presentation" class=""><a href="#assets" role="tab" id="assets-tab" data-toggle="tab" data-controls="assets">知识产权</a></li>-->
                <li role="presentation" class=""><a href="#history" role="tab" id="history-tab" data-toggle="tab" data-controls="history">历史信息</a></li>
                <li style="float: right;"><a href="javascript:;" class="btn" id="updateBtn" style="background: orange;color: #fff;" >更新当前模块数据</a></li>
            </ul>
            <div id="qcc-detail-content" class="tab-content" style="padding-top: 10px;">
                <!--#include file="./detailsByName_1.html"-->
                <!--#include file="./detailsByName_2.html"-->
                <!--##include file="./detailsByName_3.html"-->
                <!--#include file="./detailsByName_4.html"-->
                <!--##include file="./detailsByName_5.html"-->
                <!--##include file="./detailsByName_6.html"-->
                <!--#include file="./detailsByName_7.html"-->
            </div>
        </div>
        <!--#include file="./rightSide.html" -->
        <div class="goup-container" style="display: none">

        </div>
    </div>
</div>
<script src="/tmpl/js/chattelMortgage.js"></script>
<script src="/static/vendor/jquery.goup.min.js"></script>
<script>
    $.goup({
        trigger: 100,
        bottomOffset: 50,
        containerColor: "#ffa500",
        locationOffset: 100
    });
</script>
<script>
    $("#myTabs li a").dblclick(function () {
        $(this).toggleClass("switch");
        if($(this).hasClass("switch")){
            $($(this).attr("href")).find(".panel-collapse").collapse("show");
        }else{
            $($(this).attr("href")).find(".panel-collapse").collapse("hide");
        }
    });

    // 更新模块数据
    $("#updateBtn").click(function () {
        var that = $(this);
        that.addClass("disabled");
        if(that.hasClass("disabled") == false){
            return false;
        }
        layer.confirm("确定更新当前模块？",function(){
            that.removeClass("disabled");
            var loadingIndex;
            layer.msg("指令发送中...", function () {
                loadingIndex = layer.load();
                var currBlockIndex = $("#myTabs li.active").index();
                var sign;
                if(currBlockIndex === 0){
                    sign = "01";
                }else if(currBlockIndex === 1){
                    sign = "02";
                }else if(currBlockIndex === 2){
                    sign = "03";
                }else if(currBlockIndex === 3){
                    sign = "05";
                }
                if(sign == undefined){
                    layer.msg("更新指令内容为空！");
                    return
                }
                $.ajax({
                    url: remoteApi.qccUpdateQccData,
                    data: {
                        fullName: COMPANY_NAME,
                        sign: sign
                    },
                    success: function (res) {
                        if(res.success){
                            layer.msg("指令发送成功，请等待相关服务处理！");
                        }else{
                            layer.msg("指令发送失败！");
                        }
                        layer.close(loadingIndex);
                    }
                });
            });
        },function () {
            that.removeClass("disabled");
        });
    });
    // 点击【法律诉讼】模块后加载此模块数据
    $(document).on("click", "#susong-tab", function () {
        if(loadBlock2Status == false){
            loadBlock2();
        }
    });
    // 点击【经营风险】模块后加载此模块数据
    $(document).on("click", "#fengxian-tab", function () {
        if(loadBlock4Status == false){
            loadBlock4();
        }
    });
    // 点击【历史信息】模块后加载此模块数据
    $(document).on("click", "#history-tab", function () {
        if(loadBlock7Status == false){
            loadBlock7();
        }
    });
</script>
</body>
</html>